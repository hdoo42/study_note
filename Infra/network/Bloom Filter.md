---
id: 1767333184-DLUE
aliases:
  - Bloom Filter
tags:
  - algorithm
  - datastructure
---
## 1. 핵심 정의

Bloom Filter는 **"값이 존재하지 않음(Definitely No)"** 을 100% 보장하고, **"존재할지도 모름(Probably Yes)"** 이라는 확률적 불확실성을 허용하여 메모리 효율을 극대화한 자료구조입니다.

## 2. 동작 원리 (Mechanism)

### 구조

- **Bit Array:** 0으로 초기화된 $m$비트 크기의 배열.
    
- **Hash Functions:** $k$개의 서로 다른 해시 함수 ($h_1, h_2, ..., h_k$).
    

### 데이터 처리 과정

1. **추가 (Add):**
    
    - 데이터(예: `"Apple"`)를 $k$개의 해시 함수에 통과시켜 $k$개의 인덱스를 얻습니다.
        
    - Bit Array의 해당 인덱스 위치를 모두 `1`로 설정합니다.
        
2. **조회 (Check) - "즉시 확인"의 비밀:**
    
    - 조회할 데이터를 똑같이 해싱하여 $k$개의 인덱스를 얻습니다.
        
    - 해당 위치의 비트가 **모두 `1`인지 확인**합니다.
        
        - 하나라도 `0`이면: **절대 없음 (False Negative 불가능)**
            
        - 모두 `1`이면: **있을 확률이 높음 (False Positive 가능)**
            
    - **속도:** 배열 전체를 탐색(Search)하는 것이 아니라, 계산된 주소로 직접 접근(Direct Access)하므로 데이터 양과 무관하게 즉시 반환됩니다.
        

## 3. 주요 특성 및 한계

### 거짓 양성 (False Positive)

- **현상:** 저장하지 않은 데이터(예: `"Cherry"`)가 우연히 기존 데이터(`"Apple"`, `"Banana"`)들이 켜놓은 비트 조합과 일치하여 "존재한다"고 잘못 판단되는 경우.
    
- **원인:** 비트 배열 공간의 한계로 인한 **해시 충돌(Collision)**.
    
- **해결:** 적절한 배열 크기($m$)와 해시 함수 개수($k$) 설정으로 확률을 제어해야 함.
    

### 삭제 불가능 (No Deletion)

- **이유:** 비트 공유(Bit Sharing) 특성 때문.
    
- **설명:** `"Apple"`을 삭제하기 위해 관련 비트를 `0`으로 끄면, 그 비트를 공유하던 `"Banana"`까지 "없음"으로 처리되는 오류(False Negative)가 발생합니다.
    
- **대안:** Counting Bloom Filter(카운터 사용)를 쓰거나, 별도의 Whitelist(예외 허용 리스트)를 운영해야 합니다.
    

## 4. 엔지니어링 최적화 (Optimization)

### 변수 정의

- $n$: 저장할 아이템의 예상 개수 (예: 차단할 악성 IP 수)
    
- $m$: 비트 배열의 크기
    
- $k$: 해시 함수의 개수
    

### 최적의 해시 함수 개수 공식

$$k = \frac{m}{n} \ln 2 \approx 0.7 \times \frac{m}{n}$$

- **의미:** 데이터 1개당 할당된 비트 수($m/n$)의 약 **0.7배**가 최적의 $k$값입니다.
    
- **예시:** 데이터당 10비트를 할당했다면, 해시 함수는 **7개**가 수학적으로 가장 오탐률이 낮습니다.
    

### 트레이드오프 (Trade-off)

- **$k$가 너무 적을 때:** 비트가 충분히 섞이지 않아 충돌 증가.
    
- **$k$가 너무 많을 때:** 데이터 하나가 너무 많은 비트를 켜버려 배열이 빠르게 포화(Saturation)됨.
    

## 5. 성능 및 네트워크 응용

### 시간 복잡도

- **$O(k)$:** 데이터가 100개든 1억 개($n$)든 조회 속도는 동일합니다. 오직 해시 함수 개수($k$)만큼의 연산만 수행합니다.
    

### 네트워크 차단 시스템 설계 (IP:Port Filtering)

1. **메모리 설계:** 100만 개의 악성 IP($n$)를 차단하고 오탐률을 1% 미만으로 유지하려면, 약 1000만 비트($m$, 약 1.2MB)를 할당하고 해시 함수 7개($k$)를 사용합니다.
    
2. **운영 전략:**
    
    - Bloom Filter는 삭제가 안 되므로, 실수로 차단된 정상 사용자는 **Whitelist**를 통해 구제합니다.
        
    - 패킷 처리 순서: `Packet` $\rightarrow$ `Whitelist 확인` $\rightarrow$ `Bloom Filter 확인` $\rightarrow$ `최종 허용/차단`
        
3. **구현 팁:** 실제 구현 시 $k$개의 해시 함수를 모두 만드는 대신, 2개의 해시 함수($h_1, h_2$)를 선형 결합($h_1 + i \times h_2$)하여 $k$개를 시뮬레이션합니다 (Double Hashing).
